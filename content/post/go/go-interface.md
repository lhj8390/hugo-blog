+++
author = "lhj8390"
title = "Golang - μΈν„°νμ΄μ¤ μ‚¬μ©ν•κΈ°"
date = "2023-03-01"
description = "golangμ—μ„ μΈν„°νμ΄μ¤μ κ°λ…κ³Ό μ‚¬μ©λ²•, μμ λ¥Ό μ„¤λ…ν•λ‹¤."
tags = ["Go", "Golang"]
categories = ["language"]
subcategories = ["Go"]
+++

## μΈν„°νμ΄μ¤

---

> μΈν„°νμ΄μ¤λ” κµ¬μ²΄ν™”λ κ°μ²΄κ°€ μ•„λ‹ μ μΌν• μ¶”μƒ νƒ€μ…μΌλ΅, νƒ€μ…μ΄ κµ¬ν„ν•΄μ•Ό ν•λ” λ©”μ„λ“λ“¤μ„ μ •μν•λ‹¤.

μΈν„°νμ΄μ¤λ¥Ό μ‚¬μ©ν•λ©΄ μ½”λ“λ¥Ό λ³΄λ‹¤ μ μ—°ν•κ² ν•κ³  μ‚¬μ©μ¤‘μΈ κΈ°λ¥μ„ μ •ν™•ν•κ² μ„ μ–Έν•  μ μλ‹¤.

<br/>

μΈν„°νμ΄μ¤λ¥Ό μ„ μ–Έν•λ” μμ‹μ΄λ‹¤.

```go
type Stringer interface {
  String() string
}
```

μΈν„°νμ΄μ¤μ— μν•΄ μ •μλ λ©”μ†λ“λ” μΈν„°νμ΄μ¤μ λ©”μ„λ“ μ„ΈνΈλ¥Ό νΈμ¶ν•λ‹¤. μΈν„°νμ΄μ¤λ” μ΄λ¦„ λ§μ§€λ§‰μ— `er` μ„ λ¶™μΈλ‹¤.

### μΈν„°νμ΄μ¤μ νΉμ§•

Goμ μΈν„°νμ΄μ¤λ” **μ•”λ¬µμ **μΌλ΅ κµ¬ν„μ΄ λλ‹¤. κµ¬μ²΄ νƒ€μ…μ€ κµ¬ν„ν•λ” μΈν„°νμ΄μ¤λ¥Ό μ„ μ–Έν•μ§€ μ•λ”λ‹¤. μ΄ μ•”λ¬µμ μΈ ν–‰λ™μ€ μΈν„°νμ΄μ¤κ°€ <span class="red">νƒ€μ… μ•μ •μ„±</span>κ³Ό <span class="red">λ””μ»¤ν”λ§</span>μ„ κ°€λ¥ν•κ² ν•λ‹¤. β†’ <span class="gray">*μ •μ  λ° λ™μ  μ–Έμ–΄μ κΈ°λ¥μ„ μ—°κ²°ν•λ‹¤.*</span>

```go
type LogicProvider struct {}

func (lp LogicProvider) Process(data string) string {
  // business logic
}

type Logic interface {
  Process(data string) string
}

type Client struct {
  L Logic
}

func (c Client) Program() {
  // get data rm somewhere
  c.L.Process(data)
}

main() {
  c := Client{
    L: LogicProvider{},
  }
  c.Program()
}
```

Goμ—μ„λ” μΈν„°νμ΄μ¤κ°€ μμ„ λΏλ§ μ•„λ‹λΌ Client κ°€ ν•΄λ‹Ή μ‚¬ν•­μ„ μ•κ³  μλ‹¤. μΈν„°νμ΄μ¤ ν•νƒλ¥Ό λ§μ΅±ν•λ” LogicProviderμ—κ² μ„ μ–Έλ κ²ƒμ€ μ—†λ‹¤.

### μ„λ² λ”©κ³Ό μΈν„°νμ΄μ¤

κµ¬μ΅°μ²΄μ— νƒ€μ…μ„ μ„λ² λ”©ν•  μ μλ” κ²ƒμ²λΌ μΈν„°νμ΄μ¤μ— μΈν„°νμ΄μ¤λ¥Ό μ„λ² λ”©ν•  μ μλ‹¤.

```go
type Reader interface {
  Read(p []byte) (n int, err error)
}

type Closer interface {
  Close() error
}

type ReadCloser interface {
  Reader
  Closer
}
```

κµ¬μ΅°μ²΄ λ‚΄μ— μΈν„°νμ΄μ¤λ¥Ό μ„λ² λ”©ν•  μλ„ μλ‹¤.

### κµ¬μ΅°μ²΄ λ°ν™

κµ¬μ΅°μ²΄ λ€μ‹  μΈν„°νμ΄μ¤λ¥Ό λ°ν™ν•λ‹¤λ©΄ μ•”λ¬µμ  μΈν„°νμ΄μ¤μ μ£Όμ” μ¥μ μΈ <span class="red">λ””μ»¤ν”λ§μ„ μƒκ² λλ‹¤</span>. μ½”λ“κ°€ μΈν„°νμ΄μ¤λΏλ§ μ•„λ‹λΌ λ¨λ“μ— μκµ¬μ μΌλ΅ μμ΅΄ν•κΈ° λ•λ¬Έμ— ν–¥ν›„ μ μ—°μ„±μ„ μ ν•ν•λ‹¤. λν•, μΈν„°νμ΄μ¤ λ€μ‹  κµ¬μ²΄ νƒ€μ…μ΄ λ°ν™λλ‹¤λ©΄ κΈ°μ΅΄ μ½”λ“μ— μν–¥μ„ μ£Όμ§€ μ•κ³  μƒ λ©”μ„λ“μ™€ ν•­λ©μ„ μ¶”κ°€ν•  μ μλ‹¤. ν•μ§€λ§ μΈν„°νμ΄μ¤μ— μƒλ΅μ΄ λ©”μ„λ“λ¥Ό μ¶”κ°€ν•κ² λλ‹¤λ©΄ <span class="red">λ¨λ“  κµ¬ν„μ„ μ—…λ°μ΄νΈν•κ±°λ‚ μ½”λ“λ¥Ό λ§κ°€λ¨λ¦΄ μ μλ‹¤.</span>

κ°κΈ° λ‹¤λ¥Έ μΈν„°νμ΄μ¤μ μΈμ¤ν„΄μ¤λ¥Ό λ°ν™ν•λ” λ‹¨μΌ ν©ν† λ¦¬ ν•¨μλ³΄λ‹¤λ”, κ° κµ¬μ²΄ νƒ€μ…μ— λ§λ” λ¶„λ¦¬λ ν©ν† λ¦¬ ν•¨μλ¥Ό μ‘μ„±ν•λ” κ²ƒμ΄ μΆ‹λ‹¤.

<aside>
π’΅ <b>λ””μ»¤ν”λ§</b> : μΈν„°νμ΄μ¤ λ“±μ„ ν™μ©ν•μ—¬ λ¨λ“κ°„ μμ΅΄λ„λ¥Ό μµμ†ν™”ν•μ—¬ κ°λ°ν•λ” λ°©λ²•<br/>
</aside>

### nil μ‚¬μ©

μΈν„°νμ΄μ¤κ°€ nilμ΄λΌλ” κ²ƒμ€ νƒ€μ…κ³Ό κ°’ λ¨λ‘ nilμ΄μ–΄μ•Ό ν•λ‹¤.

```go
var s *string
fmt.Println(s == nil)  // true
var i interface{}
fmt.Println(i == nil)  // true
i = s
fmt.Println(i == nil)  // false
```

νƒ€μ… μ—†μ΄ λ³€μλ¥Ό κ°€μ§ μ μ—†λ“―μ΄, κ°’μ΄ μ΅΄μ¬ν•λ” ν¬μΈν„° λ³€μκ°€ nil μ΄ μ•„λ‹λΌλ©΄ ν•΄λ‹Ή νƒ€μ…μ ν¬μΈν„°λ” ν•­μƒ nil μ΄ μ•„λ‹λ‹¤ μ¦‰, <span class="red">νƒ€μ…μ΄ nilμ΄ μ•„λ‹ ν• μΈν„°νμ΄μ¤λ„ nilμ΄ μ•„λ‹λ‹¤.</span>

μΈν„°νμ΄μ¤κ°€ nilμ΄ μ•„λ‹λ©΄ ν•΄λ‹Ή μΈν„°νμ΄μ¤κ°€ κ°€μ§€λ” λ©”μ„λ“λ¥Ό μ‹¤ν–‰ν•  μ μλ‹¤. νƒ€μ…μ΄ nilμ΄ μ•„λ‹λ”λΌλ„ μΈν„°νμ΄μ¤μ™€ μ—°κ΄€λ κ°’μ΄ nilμΈμ§€ μ—¬λ¶€λ¥Ό ν™•μΈν•κΈ° νλ“¤κΈ° λ•λ¬Έμ— λ¦¬ν”λ ‰μ…μ„ μ‚¬μ©ν•μ—¬ μΈν„°νμ΄μ¤μ κ°’μ΄ nilμΈμ§€ ν™•μΈν•΄μ•Ό ν•λ‹¤.

## νƒ€μ… λ‹¨μ–Έ λ° νƒ€μ… μ¤μ„μΉ

---

> μΈν„°νμ΄μ¤ λ³€μκ°€ νΉμ • κµ¬μ²΄ νƒ€μ…μ„ κ°€μ§€κ³  μκ±°λ‚ κµ¬μ²΄ νƒ€μ…μ΄ λ‹¤λ¥Έ μΈν„°νμ΄μ¤λ¥Ό κµ¬ν„ν• κ²ƒμ„ ν™•μΈν•λ” λ°©λ²•μΌλ΅λ” **νƒ€μ… λ‹¨μ–Έ** λλ” **νƒ€μ… μ¤μ„μΉ**κ°€ μλ‹¤.
> 

### νƒ€μ… λ‹¨μ–Έ

μΈν„°νμ΄μ¤λ¥Ό κµ¬ν„ν• κµ¬μ²΄ νƒ€μ…μ μ΄λ¦„μ„ μ§€μ •ν•κ±°λ‚ μΈν„°νμ΄μ¤ κΈ°λ°μΈ κµ¬μ²΄ νƒ€μ…μ— μν•΄ κµ¬ν„λ λ‹¤λ¥Έ μΈν„°νμ΄μ¤μ μ΄λ¦„μ„ μ§€μ •ν•λ‹¤.

```go
type MyInt int

func main() {
  var i interface{}
  var mine MyInt = 20
  i = mine
  i2 := i.(MyInt)  // νƒ€μ… λ‹¨μ–Έ
  fmt.Println(i2 + 1)
}
```

νƒ€μ… λ‹¨μ–Έμ΄ μλ»λλ‹¤λ©΄ `panic: interface conversion: interface {} is main.MyInt, not ''`  κ°™μ€ ν¨λ‹‰μ„ λ³Ό μ μλ‹¤. νƒ€μ…μ΄ κΈ°λ³Έ νƒ€μ…μ„ κ³µμ ν•λ”λΌλ„ νƒ€μ… λ‹¨μ–Έμ€ κΈ°λ³Έ κ°’μ νƒ€μ…κ³Ό λ°λ“μ‹ μΌμΉν•΄μ•Ό ν•λ‹¤. β†’ <span class="gray">*`i.(int)` λ„ ν¨λ‹‰μ΄ λ°μƒν•λ‹¤.*</span>

### νƒ€μ… μ¤μ„μΉ

μΈν„°νμ΄μ¤λ¥Ό μ—¬λ¬ κ°€λ¥ν• νƒ€μ… μ¤‘ ν•λ‚λ΅ μ‚¬μ©ν•  λ•, νƒ€μ… μ¤μ„μΉλ¥Ό μ‚¬μ©ν•λ‹¤.

```go
func doThings(i interface{}) {
  switch j := i.(type) {
  case nil:
    // i = nil, jμ νƒ€μ…μ€ interface{}
  case int:
    // j int
  case MyInt:
    // j MyInt
  default:
    // λ¬΄μ¨ νƒ€μ…μΈμ§€ μ• μ μ—†κΈ° λ•λ¬Έμ— jμ νƒ€μ…μ€ interface{}
  }
}   
```

μΈν„°νμ΄μ¤κ°€ μ—°κ΄€λ νƒ€μ…μ΄ μ—†λ‹¤λ” κ²ƒμ„ λ³΄κΈ° μ„ν•΄ case μ¤‘ ν•λ‚μ— nilμ„ μ‚¬μ©ν•  μ μλ‹¤.

### μ‚¬μ©μ²

νƒ€μ… λ‹¨μ–Έμ„ μ μ©ν•κ² μ‚¬μ©ν•  μ μλ” λ°©λ²•μΌλ΅λ” μΈν„°νμ΄μ¤λ¥Ό κµ¬ν„ν• κµ¬μ²΄ νƒ€μ…μ΄ λ‹¤λ¥Έ μΈν„°νμ΄μ¤λ΅λ„ κµ¬ν„λμ–΄ μλ”μ§€ ν™•μΈν•λ” κ²ƒμ΄λ‹¤. μ΄λ” **μ„ νƒμ  μΈν„°νμ΄μ¤**λ¥Ό μ§€μ •ν•  μ μκ² ν•λ‹¤. μ„ νƒμ  μΈν„°νμ΄μ¤λ” APIλ¥Ό λ°μ „μ‹ν‚¬ λ• ν¨κ³Όμ μΌλ΅ μ‚¬μ©ν•  μ μλ‹¤.

νƒ€μ… μ¤μ„μΉλ” μ£Όμ–΄μ§„ μΈν„°νμ΄μ¤ κ°’μ΄λ‚ λ³€μκ°€ κµ¬ν„ν• νƒ€μ…μ— λ”°λΌ λ‹¤λ¥Έ μ²λ¦¬λ¥Ό ν•  μ μκ² ν•΄μ£Όλ” κΈ°λ¥μ„ μ κ³µν•λ‹¤. μΈν„°νμ΄μ¤μ— μ κ³µλ  μ μλ” νΉμ • νƒ€μ…μ΄ μλ” κ²½μ°μ— κ°€μ¥ μ ν¨ν•λ‹¤.

## μΈν„°νμ΄μ¤ μ—°κ²°

---

> Goλ” μ‚¬μ©μ μ •μ ν•¨μ νƒ€μ…μ„ ν¬ν•¨ν•μ—¬ λ¨λ“  μ‚¬μ©μ μ •μ νƒ€μ…μ— λ©”μ„λ“λ¥Ό ν—μ©ν•λ‹¤. μ΄κ²ƒμ€ ν•¨μκ°€ μΈν„°νμ΄μ¤λ¥Ό κµ¬ν„ν•  μ μλ„λ΅ ν•λ‹¤.

μΌλ°μ μΌλ΅ HTTP μ²λ¦¬λ¥Ό ν•  λ• μ‚¬μ©ν•  μ μλ‹¤.

```go
type Handler interface {
  ServeHTTP(http.ResponseWriter, *http.Request)
}

type HandlerFunc func(http.ResponseWriter, *http.Request)

func (f HandlerFunc) ServeHTTP(w http.ResponseWriter, r *http.Request) {
  f(w, r)
}
```

νƒ€μ… λ³€ν™μ„ μ‚¬μ©ν•μ—¬ http.HandlerFuncλ΅ λ³€ν™ν•μ—¬ `func(http.ResponseWriter, *http.Request)` μ‹κ·Έλ‹μ²λ¥Ό κ°€μ§€λ” λ¨λ“  ν•¨μλ¥Ό http.Handlerλ΅μ¨ μ‚¬μ©μ΄ κ°€λ¥ν•λ‹¤.<br/>
λ‹¨μΌ ν•¨μ λ‹¤λ¥Έ ν•¨μλ‚ λ‹¤λ¥Έ μƒνƒμ— μμ΅΄μ μΈ κ²ƒ κ°™λ‹¤λ©΄, μΈν„°νμ΄μ¤ νλΌλ―Έν„°λ¥Ό μ‚¬μ©ν•κ³  ν•¨μ νƒ€μ…μ„ μ„ μ–Έν•μ—¬ ν•¨μμ™€ μΈν„°νμ΄μ¤λ¥Ό μ—°κ²°ν•λ” κ²ƒμ΄ λ‚«λ‹¤.

## μ•”λ¬µμ  μΈν„°νμ΄μ¤

---

> **μμ΅΄μ„± μ£Όμ…**μ€ λ””μ»¤ν”λ§μ„ μ‰½κ² ν•κΈ° μ„ν•΄ κ°λ°λ κΈ°μ  μ¤‘ ν•λ‚λ΅, ν•΄λ‹Ή μ‘μ—… μν–‰μ΄ ν•„μ”ν• κΈ°λ¥μ„ λ…μ‹μ μΌλ΅ μ½”λ“μ— μ§€μ •ν•  μ μλ‹¤. Goμ μ•”λ¬µμ  μΈν„°νμ΄μ¤λ” μμ΅΄μ„± μ£Όμ…μ„ μ‰½κ² λ§λ“¤ μ μλ‹¤.

μμ΅΄μ„± μ£Όμ…μ„ κµ¬ν„ν•λ” μμ μ΄λ‹¤.

```go
func LogOutput(message string) {
  fmt.Println(message)
}

type SimpleDataStore struct {
  userData map[string]string
}

func (sds SimpleDataStore) UserNameForID(userID string) (string, bool) {
  name, ok := sds.userData[userID]
  return name, ok
}

func NewSimpleDataStore() SimpleDataStore {
  return SimpleDataStore{
    userData: map[string]string{
      "1": "Fred",
      "2": "Mary",
    },
  }
}
```

`LogOutput` μ΄λΌλ” λ΅κ·Έλ¥Ό λ…Έμ¶ν•λ” ν•¨μμ™€ `SimpleDataStore`μ΄λΌλ” λ°μ΄ν„° μ €μ¥μ†λ¥Ό μƒμ„±ν–λ‹¤. λΉ„μ¦λ‹μ¤ λ΅μ§μ΄ μ‹¤ν–‰λλ©΄ λ΅κ·Έλ¥Ό λ‚¨κ²¨μ•Ό ν•λ”λ°, λ‚μ¤‘μ— λ‹¤λ¥Έ λ΅κ±°λ‚ λ°μ΄ν„° μ €μ¥μ†λ¥Ό μ‚¬μ©ν•  μ μκΈ° λ•λ¬Έμ— μμ΅΄μ„±μ„ μ κ±°ν•κ³  μ‹¶λ‹¤.

<br/>

`Logger` μ™€ `DataStore` μΈν„°νμ΄μ¤λ¥Ό μ •μν•λ‹¤. λν• `LogOutput` ν•¨μκ°€ Logger μΈν„°νμ΄μ¤λ¥Ό μ¶©μ΅±ν•  μ μλ„λ΅ λ©”μ„λ“μ™€ ν•¨μ νƒ€μ…μ„ μ •μν•λ‹¤.

```go
type DataStore interface {
  UserNameForID(userID string) (string, bool)
}

type Logger interface {
  Log(message string)
}

type LoggerAdapter func(message string)

func (lg LoggerAdapter) Log(message string) {
  lg(message)
}
```

`LoggerAdapter`μ™€ `SimpleDataStore`λ” λΉ„μ¦λ‹μ¤ λ΅μ§μ— ν•„μ”ν• μΈν„°νμ΄μ¤λ¥Ό μ¶©μ΅±ν•μ§€λ§ λ‘ νƒ€μ…μ€ μΌμΉν•λ”μ§€ μ• μ μ—†λ‹¤.

<br/>

λΉ„μ¦λ‹μ¤ λ΅μ§μ„ κµ¬ν„ν• μ½”λ“μ΄λ‹¤.

```go
type SimpleLogic struct {
  l Logger
  ds DataStore
}

func (sl SimpleLogic) SayHello(userID string) (string, error) {
  sl.l.Log("Say Hello for " + userID)
  name, ok := sl.ds.UserNameForID(userID)
  if !ok {
    return "", errors.New("unknown user")
  }
  return "Hello, " + name, nil
}

func NewSimpleLogic(l Logger, ds DataStore) SimpleLogic {
  return SimpleLogic{
    l: l,
    ds: ds,
  }
}
```

Loggerμ™€ DataStore ν•­λ©μ„ κ°€μ§€λ” κµ¬μ΅°μ²΄λ¥Ό μ •μν–λ‹¤. `SimpleLogic` μ—λ” <span class="red">κµ¬μ²΄ νƒ€μ…μ„ μ–ΈκΈ‰ν•λ” λ‚΄μ©μ΄ μ—†μΌλ―€λ΅ μμ΅΄μ„±μ΄ μ—†λ‹¤.</span> λ‚μ¤‘μ— μƒλ΅μ΄ κµ¬ν„μΌλ΅ λ°”κΎΈλ”λΌλ„ κ³µκΈ‰μκ°€ ν•΄λ‹Ή μΈν„°νμ΄μ¤μ™€ μ—°κ΄€μ΄ μ—†κΈ° λ•λ¬Έμ— μ•„λ¬΄λ° λ¬Έμ κ°€ μ—†λ‹¤.

<br/>

main ν•¨μμ—μ„ λ¨λ“  μ»΄ν¬λ„νΈλ¥Ό κµ¬μ„±ν•λ‹¤.

```go
func main() {
  l := LoggerAdapter(LogOutput)
  ds := NewSimpleDataStore()
  logic := NewSimpleLogic(l, ds)
  fmt.Println(logic.SayHello("1"))
}
```

main ν•¨μλ” <span class="red">λ¨λ“  κµ¬μ²΄ νƒ€μ…μ΄ μ‹¤μ  λ¬΄μ—‡μΈμ§€ μ•κ³  μλ” μ μΌν• λ¶€λ¶„</span>μ΄λ‹¤. λ§μ•½ λ‹¤λ¥Έ κµ¬ν„μΌλ΅ κµμ²΄ν•λ ¤λ©΄ main ν•¨μμ—μ„λ§ λ³€κ²½ν•λ©΄ λλ‹¤. μμ΅΄μ„± μ£Όμ…μ€ ν…μ¤νΈλ¥Ό λ” μ‰½κ² λ§λ“¤ μ μλ” ν›λ¥­ν• ν¨ν„΄μ΄λ‹¤.

<br/>