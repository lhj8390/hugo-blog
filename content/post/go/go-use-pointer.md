+++
author = "lhj8390"
title = "Golang - ν¬μΈν„° μ‚¬μ©ν•κΈ°"
date = "2023-02-20"
description = "golangμ—μ„ ν¬μΈν„°μ κ°λ… λ° ν•¨μμ—μ„μ μ‚¬μ©λ²•, μ£Όμμ‚¬ν•­μ— λ€ν•΄ μ„¤λ…ν•λ‹¤."
tags = ["Go", "Golang"]
categories = ["language"]
subcategories = ["Go"]
+++
## ν¬μΈν„°μ κ°λ…

---

> ν¬μΈν„°λ” κ°’μ΄ μ €μ¥λ λ©”λ¨λ¦¬μ μ„μΉ κ°’μ„ κ°€μ§€κ³  μλ” λ³€μμ΄λ‹¤.
> 

λ¨λ“  λ³€μλ” ν•λ‚ μ΄μƒμ μ—°μ†λ λ©”λ¨λ¦¬ κ³µκ°„μ— μ €μ¥λλ”λ°, κ·Έκ²ƒμ„ **μ£Όμ†**λΌκ³  λ¶€λ¥Έλ‹¤. ν¬μΈν„°λ” λ‹¨μν λ‹¤λ¥Έ λ³€μκ°€ μ €μ¥λ μ£Όμ†λ¥Ό λ‚΄μ©μΌλ΅ κ°€μ§€λ” λ³€μμ΄λ‹¤.

```go
var x int32 = 10
var y bool = true
pointerX := &x
pointerY := &y
var pointerZ *string
```

{{<figure src="/images/go-use-pointer/1.png" class="large">}}

μ„λ΅ λ‹¤λ¥Έ νƒ€μ…μ€ μ„λ΅ λ‹¤λ¥Έ μμ λ©”λ¨λ¦¬λ¥Ό μ°¨μ§€ν•μ§€λ§, λ¨λ“  ν¬μΈν„°λ” μ–΄λ–¤ νƒ€μ…μ„ κ°€λ¦¬ν‚¤λ κ°„μ— ν•­μƒ κ°™μ€ ν¬κΈ°λ¥Ό κ°€μ§„λ‹¤. `pointerX` μ κ°’μ€ xμ μ£Όμ†μΈ 1, `pointerY` μ κ°’μ€ yμ μ£Όμ†μΈ 5, `pointerZ` λ” μ•„λ¬΄κ²ƒλ„ κ°€λ¦¬ν‚¤κ³  μμ§€ μ•κΈ° λ•λ¬Έμ— 0μ κ°’μ„ κ°€μ§„λ‹¤. **ν¬μΈν„°μ μ λ΅ κ°’μ€ nilμ΄λ‹¤.**

<br/>

```go
x := 10
pointerToX := &x
fmt.Println(pointerToX)    // λ©”λ¨λ¦¬ μ£Όμ† μ¶λ ¥
fmt.Println(*pointerToX)   // 10

z := 5 + *pointerToX
fmt.Println(z)             // 15
```

`&` λ” μ£Όμ† μ—°μ‚°μλ΅, λ³€μ μ•μ— `&`λ¥Ό λ¶™μ΄λ©΄ ν•΄λ‹Ή λ³€μμ κ°’μ΄ μ €μ¥λ λ©”λ¨λ¦¬ μ„μΉμ μ£Όμ†λ¥Ό λ°ν™ν•λ‹¤.<br/>
`*`λ” κ°„μ ‘ μ—°μ‚°μλ΅, ν¬μΈν„° νƒ€μ… λ³€μ μ•μ— λ¶™μ΄λ©΄ κ°€λ¦¬ν‚¤λ” κ°’μ„ λ°ν™ν•κ³  <span class="red">μ—­μ°Έμ΅°</span>λΌκ³  λ¶€λ¥Έλ‹¤.

<aside>
π’΅ ν¬μΈν„° μ—­μ°Έμ΅° μ „μ— ν¬μΈν„°κ°€ nilμ΄ μ•„λ‹μ§€ ν™•μΈμ΄ ν•„μ”ν•λ‹¤. nilμ„ κ°€μ§„ ν¬μΈν„°λ΅ μ—­μ°Έμ΅°λ¥Ό μ‹λ„ν•λ©΄ ν¨λ‹‰μ„ μΌμΌν‚¨λ‹¤.<br/>

</aside>

### ν¬μΈν„° νƒ€μ…

ν¬μΈν„°κ°€ μ–΄λ–¤ νƒ€μ…μ„ κ°€λ¦¬ν‚¤λ”μ§€ λ‚νƒ€λ‚Έλ‹¤.

```go
x := 10
var pointerToX *int
pointerToX = &x
```

νƒ€μ…(int) μ•μ— *λ¥Ό μ‚¬μ©ν•μ—¬ μ‘μ„±ν•λ‹¤. λ¨λ“  νƒ€μ…μ„ κΈ°λ°μΌλ΅ λ§λ“¤ μ μλ‹¤.

<br/>

λ‚΄μ¥ ν•¨μ newλ” ν¬μΈν„° λ³€μλ¥Ό μƒμ„±ν•λ‹¤. 

```go
var x = new(int)
fmt.Println(x == nil)  // false
fmt.Println(*x)        // 0
```

μ κ³µλ νƒ€μ…μ μ λ΅ κ°’μ„ λ‚νƒ€λ‚΄λ” ν¬μΈν„°λ¥Ό λ°ν™ν•λ‹¤. 

### κΈ°λ³Έ νƒ€μ… λ¦¬ν„°λ΄μ—μ„μ ν¬μΈν„°

κΈ°λ³Έ νƒ€μ… λ¦¬ν„°λ΄(μ«μ, λ¶λ¦¬μ–Έ, λ¬Έμμ—΄)λ‚ μƒμ μ•μ—λ” λ©”λ¨λ¦¬ μ£Όμ†λ¥Ό κ°€μ§€μ§€ μ•κΈ° λ•λ¬Έμ— &λ¥Ό μ‚¬μ©ν•  μ μ—†λ‹¤. κΈ°λ³Ένƒ€μ…μ„ μ„ν• ν¬μΈν„°κ°€ ν•„μ”ν•λ©΄ λ‹¤μκ³Ό κ°™μ΄ μ‚¬μ©ν•λ‹¤.

```go
var x string
y := &x
```

<br/>

ν•λ‚μ κµ¬μ΅°μ²΄ λ‚΄μ— κΈ°λ³Έ νƒ€μ…μ„ κ°€λ¦¬ν‚¤λ” ν¬μΈν„°κ°€ μλ‹¤λ©΄, λ¦¬ν„°λ΄μ„ ν•΄λ‹Ή ν•­λ©μ— μ§μ ‘ ν• λ‹Ήν•  μ μ—†λ‹¤.
```go
type person struct {
  FirstName string
  LastName *string
}

p := person{
  FirstName "Pat",
  LastName: "Perry",  // μ»΄νμΌ μ—λ¬
}
```

μ΄ λ¬Έμ λ¥Ό ν•΄κ²°ν•λ ¤λ©΄ λ‘ κ°€μ§€ λ°©λ²•μ΄ μ΅΄μ¬ν•λ‹¤.

1. λ³€μμ— μƒμμ κ°’μ„ κ°€μ§€κ² ν•λ‹¤.
2. ν—¬νΌ ν•¨μλ¥Ό μ‘μ„±ν•μ—¬ λ¶λ¦¬μ–Έ, μ«μ, λ¬Έμμ—΄ νƒ€μ…μ„ νλΌλ―Έν„°λ΅ λ°›μ•„ ν•΄λ‹Ή νƒ€μ…μ ν¬μΈν„°λ¥Ό λ°ν™ν•λ‹¤.

<br/>

```go
func stringp(s string) *string {
  return &s
}

p := person{
  FirstName: "Pat",
  LastName: stringp("Perry"),
}
```

μƒμλ¥Ό ν•¨μλ΅ μ „λ‹¬ν–μ„ λ–„, μƒμλ” νλΌλ―Έν„°λ΅ λ³µμ‚¬λκ³  λ³€μκ°€ λκΈ° λ•λ¬Έμ— λ©”λ¨λ¦¬μ—μ„ μ£Όμ†λ¥Ό κ°€μ§€κ² λλ‹¤. ν•΄λ‹Ή ν•¨μλ” κ²°κµ­ λ³€μμ λ©”λ¨λ¦¬ μ£Όμ†λ¥Ό λ°ν™ν•  μ μκ² λλ‹¤.

## ν•¨μμ—μ„μ μ‚¬μ©

---

> Goλ” κ°’μ— μν• νΈμ¶μ„ μ‚¬μ©ν•λ” μ–Έμ–΄μ΄κΈ° λ•λ¬Έμ— κΈ°λ³Ένƒ€μ…, κµ¬μ΅°μ²΄, λ°°μ—΄κ³Ό κ°™μ€ λΉ„ ν¬μΈν„° νƒ€μ…λ“¤μ€ νΈμ¶λ ν•¨μμ—μ„ μ›λ³Έμ λ¶λ³€μ„±μ„ λ³΄μ¥ν•λ‹¤. ν•μ§€λ§ ν¬μΈν„°κ°€ ν•¨μλ΅ μ „λ‹¬λλ©΄ νΈμ¶λ ν•¨μμ—μ„ μ›λ³Έ λ°μ΄ν„°λ¥Ό μμ •ν•  μ μλ‹¤.
> 

ν¬μΈν„°λ¥Ό ν•¨μμ—μ„ μ‚¬μ©ν•  λ• κ³ λ ¤ν•  μ‚¬ν•­μ€ λ‹¤μκ³Ό κ°™λ‹¤.

**1. nil ν¬μΈν„°λ¥Ό ν•¨μλ΅ μ „λ‹¬ν–μ„ λ•, ν•΄λ‹Ή κ°’μ„ nilμ΄ μ•„λ‹ κ°’μΌλ΅ λ§λ“¤ μ μ—†λ‹¤.**

```go
func failedUpdate(g *int) {
  x := 10
  g = &x
}

func main() {
  var f *int      // f = nil
  failedUpdate(f)
  fmt.Println(f)  // nil
```

μμ‹μ—μ„ `f` λ³€μλ” nilμ„ κ°€μ§€κ³  μ‹μ‘ν•λ”λ°, failedUpdateλ¥Ό νΈμ¶ν•λ©΄ λ‚΄λ¶€μ—μ„ `g` λ³€μκ°€ `x`λ¥Ό κ°€λ¦¬ν‚¤λ„λ΅ λ³€κ²½λμ§€,  mainμ— μλ” `f` λ³€μλ¥Ό λ³€κ²½ν•μ§€λ” μ•λ”λ‹¤. λ”°λΌμ„ failedUpdateκ°€ μΆ…λ£λκ³  mainμΌλ΅ λμ•„μ™€λ„ `f` λ³€μλ” μ—¬μ „ν nilμ„ κ°€μ§„λ‹¤. <span class="red">μ¦‰, ν¬μΈν„°μ— μ΄λ―Έ ν• λ‹Ήλ κ°’μ΄ μλ” κ²½μ°μ—λ§ κ°’μ„ μ¬ν• λ‹Ή ν•  μ μλ‹¤.</span>

<br/>

**2. ν¬μΈν„° νλΌλ―Έν„°μ— ν• λ‹Ήλ κ°’μ„ μ μ§€ν•λ ¤λ©΄ ν¬μΈν„°λ¥Ό <span class="red">μ—­μ°Έμ΅°</span>ν•μ—¬ κ°’μ„ μ„¤μ •ν•΄μ•Ό ν•λ‹¤.**

```go
func failedUpdate(px *int) {
  x2 := 20
  px = &x2
}

func update(px *int) {
  *px = 20
}

func main() {
  x := 10
  failedUpdate(&x)
  fmt.Println(x)   // 10
  update(&x)
  fmt.Println(x)   // 20
}
```

failedUpdateμ—μ„λ” **`px`** ν¬μΈν„°κ°€ **`x2`** μ μ£Όμ†λ¥Ό κ°€λ¦¬ν‚¤λ„λ΅ λ³€κ²½λμ§€λ§, μ΄λ” **`x`** μ μ£Όμ†μ™€λ” κ΄€λ ¨μ΄ μ—†λ‹¤. λ”°λΌμ„ mainμΌλ΅ λμ•„μ™”μ„ λ•, mainμ `x` μ κ°’μ€ λ³€κ²½λμ§€ μ•λ”λ‹¤. ν•μ§€λ§ <span class="red">update μ—μ„λ” `x` μ μ£Όμ†λ¥Ό κ°€λ¦¬ν‚¤κ³  μλ” `px` νλΌλ―Έν„°λ¥Ό μ—­μ°Έμ΅°ν•μ—¬ κ°’μ„ μμ •ν–κΈ° λ•λ¬Έμ— mainμ `x` κ°’μ΄ λ³€κ²½λλ‹¤.</span>

## ν¬μΈν„° μ‚¬μ©μ‹ μ£Όμμ‚¬ν•­

---

> ν¬μΈν„°λ” λ°μ΄ν„° νλ¦„μ„ μ΄ν•΄ν•κΈ° μ–΄λ µκ² λ§λ“¤λ©°, κ°€λΉ„μ§€ μ»¬λ ‰ν„°μ—κ² μ¶”κ°€μ μΈ μ‘μ—…μ„ μ¤€λ‹¤.
> 

### μ•ν‹° ν¨ν„΄

```go
func MakeFoo(f *Foo) error {
  f.Field1 = "val"
  f.Field2 = 20
  return nil
}
```

κµ¬μ΅°μ²΄ μ „λ‹¬μ„ ν¬μΈνΈλ΅ ν•μ—¬ ν•­λ©μ„ μ±„μ°λ” κ²ƒμ€ μΆ‹μ§€ μ•μ€ μ½”λ“μ΄λ‹¤.

### λ¨λ²” ν¨ν„΄

```go
func MakeFoo() (Foo, error) {
  f := Foo{
    Field1: "val",
    Field2: 20,
  }
  return f, nil
}
```

ν•¨μ λ‚΄μ—μ„ κµ¬μ΅°μ²΄λ¥Ό μ΄κΈ°ν™”ν•κ³  λ°ν™ν•λ” κ²ƒμ΄ μΆ‹λ‹¤.

### ν¬μΈν„° νλΌλ―Έν„°λ¥Ό μ‚¬μ©ν•λ” κ²½μ°

ν¬μΈν„° νλΌλ―Έν„°λ¥Ό μ‚¬μ©ν•΄μ•Ό ν•λ” κ²½μ°λ” ν•¨μκ°€ ν•΄λ‹Ή ν¬μΈν„°λ¥Ό μΈν„°νμ΄μ¤λ΅ μμƒν•λ” κ²½μ°μ—λ§ μ μ©λλ‹¤.

```go
f := struct {
  Name string `json:"name"`
  Age int `json:"age"`
}
err := json.Unmarshal([]byte(`{"name": "Bob", "age": 30}`), &f)
```

μ¶©λ¶„ν ν° κµ¬μ΅°μ²΄μ κ²½μ°, ν¬μΈν„°λ¥Ό μ΄μ©ν•μ—¬ μ…λ ¥ νλΌλ―Έν„° λλ” λ°ν™κ°’μΌλ΅ κµ¬μ΅°μ²΄λ¥Ό μ‚¬μ©ν•μ—¬ μ„±λ¥μ„ ν–¥μƒμ‹ν‚¬ μ μλ‹¤. λ¨λ“  λ°μ΄ν„° νƒ€μ…μ„ μ„ν• ν¬μΈν„°μ ν¬κΈ°κ°€ λ™μΌν•κΈ° λ•λ¬Έμ΄λ‹¤. λ€κ°μ κ²½μ°, ν¬μΈν„°λ¥Ό μ‚¬μ©ν•λ” κ²ƒμ΄ ν”„λ΅κ·Έλ¨ μ„±λ¥μ— μν–¥μ„ μ£Όμ§€ μ•μ§€λ§, ν•¨μ κ°„μ— λ©”κ°€λ°”μ΄νΈ μ΄μƒμ λ°μ΄ν„°λ¥Ό μ „λ‹¬ν•λ” κ²½μ° κ³ λ ¤ν•΄λ³Όλ§ ν•λ‹¤.

### μ¬λΌμ΄μ¤λ¥Ό μ‚¬μ©ν•λ” κ²½μ°

μ¬λΌμ΄μ¤λ” κΈΈμ΄, μμ©λ ¥, λ©”λ¨λ¦¬ λΈ”λ΅μ„ κ°€λ¦¬ν‚¤λ” ν¬μΈν„°, 3κ°μ ν•­λ©μ„ μ΄λ£¨λ” κµ¬μ΅°μ²΄λ΅ μ΄λ£¨μ–΄μ Έ μλ‹¤. ν•¨μλ΅ μ¬λΌμ΄μ¤λ¥Ό λ„κΈΈ κ²½μ° μ•„λμ™€ κ°™μ€ μ‚¬μ§„μ²λΌ λ³µμ λλ‹¤. κΈΈμ΄μ™€ μμ©λ ¥μ„ λ³€κ²½ν•λ” κ²ƒμ€ λ³µμ‚¬λ³Έλ§ λ³€κ²½λμ§€ μ›λ³Έμ΄ λ°”λ€” μκ°€ μ—†λ‹¤.

{{<figure src="/images/go-use-pointer/2.png" class="large">}}

μ¦‰, μ¬λΌμ΄μ¤μ λ‚΄μ©μ„ μμ •ν•λ” κ²ƒμ€ μ›λ³Έμ— λ°μμ΄ λμ§€λ§ appendλ¥Ό ν†µν•΄ κΈΈμ΄λ¥Ό λ³€κ²½ν•λ” κ²ƒμ€ <span class="red">μ¬λΌμ΄μ¤μ μμ©λ ¥κ³Ό κ΄€κ³„ μ—†μ΄ μ›λ³Έμ— λ°μλμ§€ μ•λ”λ‹¤.</span> κΈ°λ³Έμ μΌλ΅ ν•¨μλ΅ λ„κ²¨μ§„ μ¬λΌμ΄μ¤λ” μμ •ν•μ§€ μ•λ” κ²ƒμ΄ κ¶μ¥λλ‹¤.